machine: 
  services:
    - docker
dependencies:
  cache_directories:
    - "~/docker"
  pre:
    - wget https://github.com/Medium/phantomjs/releases/download/v2.1.1/phantomjs-2.1.1-linux-x86_64.tar.bz2
    - sudo tar xvjf phantomjs-2.1.1-linux-x86_64.tar.bz2
    - sudo mv phantomjs-2.1.1-linux-x86_64 /home/ubuntu/bin/
    - sudo chmod a+x /home/ubuntu/bin/phantomjs-2.1.1-linux-x86_64
    - sudo ln -s --force /home/ubuntu/bin/phantomjs-2.1.1-linux-x86_64/bin/phantomjs /usr/local/bin/phantomjs
    - npm install -g casperjs@1.1.3
    - phantomjs -v
    - casperjs --version
  override:
    - if [[ -e ~/docker/image.tar ]]; then docker load -i ~/docker/image.tar; fi
    - docker-compose build
    - mkdir -p ~/docker; docker save test_web > ~/docker/image.tar
test:
  override:
    - docker-compose up -d
    - pwd
    - ls -al
    - sh file.sh